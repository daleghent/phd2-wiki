This page describes how to set up a build environment from scratch on MS-Windows to compile and run PHD2.

# Summary #

  1. Install CMake
  1. Get the Visual Studio C++ compiler
  1. Install Visual Leak Detector (optional)
  1. Install wxWidgets
  1. Install opencv
  1. Get the PHD2 source code
  1. Generate the Visual Studio project files
  1. Compile and run PHD2

# Step-by-step #

1. Install [CMake](http://www.cmake.org/), the cross-platform build system:

> https://www.cmake.org/download/

2. If you do not yet have a version of Visual Studio 2013 for Windows Desktop then download it from

> https://visualstudio.microsoft.com/vs/older-downloads/

The download you want is **Visual Studio Express 2013 for Windows Desktop** or **Visual Studio Community 2013**.

Visual Studio 2013 requires Windows 7 SP1 or later; it will not install on Windows XP.

Both are free but will require you to register with Microsoft.

3. (Optional) Download and install Visual Leak Detector (VLD) from

> https://github.com/KindDragon/vld/releases

4. Download wxWidgets 3.0.5 from

> https://www.wxwidgets.org/downloads/

PHD2 requires wxWidgets static libraries, not DLLs, so you need to build them as follows.

Install wxWidgets into &lt;wx install path&gt;, typically C:\wxWidgets-3.0.5.

Set a WXWIN environment variable to point to &lt;wx install path&gt;. For example:

> WXWIN = C:\wxWidgets-3.0.5

Open a Visual Studio command prompt (menu Tools => Visual Studio Command Prompt) and run two command line builds, one for release, one for debug:

```
cd %WXWIN%\build\msw
msbuild wx_vc12.sln /p:configuration=Debug /p:platform=win32 /m:8
msbuild wx_vc12.sln /p:configuration=Release /p:platform=win32 /m:8
```


> _Extra Info_ wxWidgets sources are downloaded as a zip file. You should stick with the 3.0.5 release used in the current PHD2 build. On the wxWidgets site, go to the downloads page and find the correct release.  If you don't see it there, go to the home page for wxWidgets and look in the 'News' paragraphs.  Once it’s downloaded, extract into a location you want.

> Then set the WXWIN environment variable as follows:  suppose you’ve installed wxWidgets in a folder c:\dev\CPP\_Libs\wxWidgets-3.0.5\.  Then the environment variable should look like this:

> WXWIN = C:\dev\CPP\_Libs\wxWidgets-3.0.5


5. Download OpenCV 2.4.10 from

> http://sourceforge.net/projects/opencvlibrary/files/opencv-win/

Run the self extracting executable, and put the opencv folder in any location you like.

Set an environment variable OPENCV\_DIR pointing to the install location.  For example, if you installed to C:\opencv-2.4.10 then you would set

> OPENCV\_DIR = C:\opencv-2.4.10

6. Get the PHD2 source tree from the GitHub. Our project page is https://github.com/OpenPHDGuiding

```
  git clone https://github.com/OpenPHDGuiding/phd2.git
```

7. Generate the Visual Studio project files

The Visual studio project files are generated by cmake based on the CMake input files, primarily CMakeLists.txt.  For more information see [CMakeBuildSystem](CMakeBuildSystem.md). All the build output (including the project files) goes into a temporary directory.  Open a command prompt and cd to the PHD2 source directory and run the following:

```
  mkdir tmp
  cd tmp
  cmake -G "Visual Studio 12" -DwxWidgets_PREFIX_DIRECTORY=%WXWIN% -DOpenCVRoot=%OPENCV_DIR% ..
```

For convenience, there is a batch file containing those commands in the top-level source directory, so you can just run that to do the same thing:

```
  run_cmake.bat
```

8. Build and run PHD2.

Open the solution phd2.sln in the tmp directory. Build the ALL\_BUILD project in the solution using the Debug and Release configurations.

You will see some warnings when building the cfitsio library, but those can be safely ignored. Everything else should compile cleanly without warnings or errors.